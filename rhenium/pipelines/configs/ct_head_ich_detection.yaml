# Rhenium OS Pipeline Configuration
# Head CT ICH Detection Pipeline

name: ct_head_ich_detection
version: "1.0.0"
description: "Head CT intracranial hemorrhage detection and characterization"

pipeline_type: ct_head

# Input configuration
input:
  modality: CT
  body_part: HEAD
  protocols:
    - NON_CONTRAST_HEAD

# Preprocessing steps
preprocessing:
  steps:
    - type: window_level
      params:
        brain_window:
          level: 40
          width: 80
        subdural_window:
          level: 75
          width: 215
        bone_window:
          level: 600
          width: 2800
    - type: skull_stripping
      params:
        method: threshold_morphology
    - type: slice_thickness_standardization
      params:
        target_thickness: 5.0

# Reconstruction settings
reconstruction:
  enabled: false

# Perception models
perception:
  ich_detection:
    enabled: true
    model: ich_detection_v2
    subtypes:
      - epidural
      - subdural
      - subarachnoid
      - intraparenchymal
      - intraventricular
    threshold: 0.5
  midline_shift:
    enabled: true
    model: midline_shift_estimation_v1
  mass_effect:
    enabled: true
    model: mass_effect_detection_v1

# Quantitative analysis
quantification:
  hemorrhage_volume: true
  midline_shift_mm: true
  involved_regions: true
  hounsfield_statistics: true

# XAI settings
xai:
  visual:
    enabled: true
    types:
      - detection_overlay
      - windowed_views
      - saliency_map
  quantitative:
    enabled: true
    measurements:
      - hemorrhage_volume_ml
      - max_hemorrhage_hu
      - midline_shift_mm
  narrative:
    enabled: true

# MedGemma settings
medgemma:
  enabled: true
  template: ct_head_trauma
  generate_report: true
  explain_findings: true
  validators:
    - narrative_consistency
    - high_risk
    - overconfidence

# Output settings
output:
  format: json
  include_dossiers: true
  priority_flag: urgent

# Performance mode
performance:
  mode: fast  # Fast mode for urgent triage
  gpu_required: true
