# Rhenium OS Pipeline Configuration
# Brain MRI Lesion Analysis Pipeline

name: mri_brain_lesions
version: "1.0.0"
description: "Brain MRI lesion segmentation and characterization pipeline"

pipeline_type: mri_brain

# Input configuration
input:
  modality: MR
  body_part: BRAIN
  required_sequences:
    - T1
    - T2
    - FLAIR
  optional_sequences:
    - T1_CONTRAST
    - DWI

# Preprocessing steps
preprocessing:
  steps:
    - type: skull_stripping
      params:
        method: deep_learning
    - type: bias_field_correction
      params:
        n4itk: true
    - type: registration
      params:
        reference: MNI_template
        method: affine
    - type: intensity_normalization
      params:
        method: zscore

# Reconstruction settings
reconstruction:
  enabled: false

# Perception models
perception:
  white_matter_lesions:
    enabled: true
    model: wm_lesion_segmentation_v2
    input_sequences: [FLAIR, T1]
    threshold: 0.5
  tumor_segmentation:
    enabled: true
    model: brain_tumor_segmentation_v1
    input_sequences: [T1, T1_CONTRAST, T2, FLAIR]
  hemorrhage_detection:
    enabled: true
    model: brain_hemorrhage_detection_v1
    input_sequences: [T1, T2]
    threshold: 0.7

# Quantitative analysis
quantification:
  lesion_volume: true
  lesion_count: true
  atrophy_index: true
  regional_volumes:
    - hippocampus
    - ventricles
    - white_matter
    - gray_matter

# XAI settings
xai:
  visual:
    enabled: true
    types:
      - segmentation_overlay
      - lesion_probability_map
      - saliency_map
  quantitative:
    enabled: true
    measurements:
      - lesion_count
      - total_lesion_volume
      - largest_lesion_diameter
      - regional_atrophy
  narrative:
    enabled: true

# MedGemma settings
medgemma:
  enabled: true
  template: mri_brain_neuroradiology
  generate_report: true
  explain_findings: true
  validators:
    - narrative_consistency
    - laterality
    - high_risk

# Output settings
output:
  format: json
  include_dossiers: true
  include_segmentations: true
  export_nifti: false
