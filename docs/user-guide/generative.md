# Generative Models Guide

## Overview

Rhenium OS includes generative models for:
- **Image Translation** (Pix2Pix, CycleGAN)
- **Super-Resolution** (SRGAN/ESRGAN)
- **Disclosure Tracking** for generated images

> **Important**: All generated images are automatically stamped with disclosure metadata to prevent misuse.

---

## Pix2Pix (Paired Translation)

For tasks with paired training data:

```python
from rhenium.generative.pix2pix import Pix2PixGenerator, PatchDiscriminator

generator = Pix2PixGenerator(in_ch=1, out_ch=1, features=64)
discriminator = PatchDiscriminator(in_ch=2)

# Generate
fake_B = generator(real_A)

# Discriminator
d_real = discriminator(torch.cat([real_A, real_B], dim=1))
d_fake = discriminator(torch.cat([real_A, fake_B], dim=1))
```

### Use Cases
- MRI contrast synthesis (T1 → T2)
- CT denoising
- PET attenuation correction

---

## CycleGAN (Unpaired Translation)

For unpaired domain translation:

```python
from rhenium.generative.cyclegan import CycleGANGenerator, CycleGAN

G_AB = CycleGANGenerator(n_res=9)  # A → B
G_BA = CycleGANGenerator(n_res=9)  # B → A

cyclegan = CycleGAN(G_AB, G_BA, D_A, D_B, lambda_cyc=10.0)

losses = cyclegan.generator_loss(real_A, real_B)
```

### Cycle Consistency

\[
\mathcal{L}_{cyc} = \|G_{BA}(G_{AB}(x)) - x\|_1 + \|G_{AB}(G_{BA}(y)) - y\|_1
\]

---

## Super-Resolution (SRGAN)

```python
from rhenium.generative.srgan import SRGenerator

generator = SRGenerator(
    in_ch=1,
    out_ch=1,
    n_rrdb=16,
    upscale=4,  # 4x upsampling
)

hr_image = generator(lr_image)
```

---

## Disclosure Tracking

**All generated images must be marked as AI-generated:**

```python
from rhenium.generative.disclosure import GenerationMetadata, stamp_generated
from pathlib import Path

metadata = GenerationMetadata(
    generator_name="pix2pix_t1_to_t2",
    generator_version="1.0.0",
    disclosure="This image was generated by AI",
)

# Creates sidecar .generated.json file
stamp_generated(Path("output.nii.gz"), metadata)
```

### Sidecar JSON

```json
{
  "generated_at": "2025-01-01T12:00:00",
  "generator": "pix2pix_t1_to_t2:1.0.0",
  "disclosure": "This image was generated by AI"
}
```
